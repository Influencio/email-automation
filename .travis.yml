# Use Dockerized infrastructure
sudo: enabled

# Cache Gcloud SDK between commands
cache:
  directories:
    - "$HOME/google-cloud-sdk/"

# Install services
services:
  - docker  

before_deploy:
  - chmod +x ci/setup-gcp.sh
  - ci/setup-gcp.sh
  - chmod +x ./ci/prod-deploy.sh

deploy:
  - provider: script
    script: ./ci/prod-deploy.sh
    skip_cleanup: true
    on:
      branch: master